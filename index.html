<!DOCTYPE html>
<html><head><meta charset="utf-8"><title>EA 云控中心</title>
<style>
  body{font:18px Arial;background:#000;color:#0f0;padding:20px}
  table{border-collapse:collapse;width:100%}
  th,td{border:1px solid #0f0;padding:12px;text-align:center}
  button{padding:10px 20px;margin:5px;background:#0f0;color:#000;border:0;cursor:pointer}
  .stop{background:#f00}
</style></head><body>
<h1>EA 云控中心（点一下就停）</h1>
<table><thead><tr><th>账户ID</th><th>最后上线</th><th>状态</th><th>操作</th></tr></thead>
<tbody id="list"></tbody></table>

<script>
function load(){
  fetch('users.txt?t='+Date.now()).then(r=>r.text()).then(t=>{
    let html='', lines=t.trim().split('\n');
    lines.forEach(l=>{
      if(!l) return;
      let [id,time,status]=l.split('|');
      let dt = new Date(time*1000).toLocaleString();
      html+=`<tr><td>${id}</td><td>${dt}</td><td>${status}</td>
        <td>
          <button onclick="set('${id}','GO')"   class="${status==='GO'?'stop':''}">开</button>
          <button onclick="set('${id}','STOP')" class="${status==='STOP'?'stop':''}">停</button>
        </td></tr>`;
    });
    document.getElementById('list').innerHTML=html||'<tr><td colspan="4">暂无用户</td></tr>';
  });
}
function set(id,cmd){
  // 真正一键生成 control/xxx.txt 文件
  fetch(`https://api.github.com/repos/你的用户名/eatest/contents/control/${id}.txt`, {
    method: 'PUT',
    headers: {'Authorization': 'token 你的token','Accept': 'application/vnd.github.v3+json'},
    body: JSON.stringify({
      message: "update status",
      content: btoa(cmd),
      branch: "main"
    })
  }).then(()=>load());
}
setInterval(load,8000); load();
</script>
</body></html>
