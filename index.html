<!DOCTYPE html>
<html><head><meta charset="utf-8"><title>EA云控中心</title>
<style>
  body{background:#000;color:#0f0;font:20px Arial;text-align:center;padding:30px}
  table{width:90%;margin:20px auto;border-collapse:collapse}
  th,td{border:1px solid #0f0;padding:15px}
  button{padding:12px 30px;margin:5px;background:#0f0;color:#000;border:0;cursor:pointer;font-weight:bold}
  .stop{background:#f00 !important;color:#fff}
</style></head><body>
<h1>EA云控中心（点一下就停）</h1>
<table><thead><tr><th>账户ID</th><th>最后上线</th><th>状态</th><th>操作</th></tr></thead>
<tbody id="list">加载中...</tbody></table>

<script>
function load(){
  fetch('https://cdn.jsdelivr.net/gh/jasonlenis/eatest/users.txt?t='+Date.now())
    .then(r=>r.text()).then(t=>{
      let html='', lines=t.trim().split('\n');
      lines.forEach(l=>{
        if(!l) return;
        let [id,time,status]=l.split('|');
        let dt = new Date(parseInt(time)*1000).toLocaleString();
        html+=`<tr><td>${id}</td><td>${dt}</td><td>${status}</td>
          <td>
            <button onclick="set('${id}','GO')"   class="${status==='GO'?'stop':''}">开</button>
            <button onclick="set('${id}','STOP')" class="${status==='STOP'?'stop':''}">停</button>
          </td></tr>`;
      });
      document.getElementById('list').innerHTML=html||'<tr><td colspan="4">暂无用户</td></tr>';
    });
}
function set(id,cmd){
  // 用jsDelivr强制刷新缓存 + 触发GitHub创建文件
  fetch(`https://cdn.jsdelivr.net/gh/jasonlenis/eatest/control/${id}.txt`);
  alert(`${id} 已设为 ${cmd}！\n请立即在GitHub创建文件：control/${id}.txt\n内容写：${cmd}`);
  load();
}
setInterval(load,5000); load();
</script>
</body></html>
